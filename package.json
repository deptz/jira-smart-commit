{
  "name": "jira-smart-commit",
  "displayName": "JIRA Smart Commit",
  "description": "Generate Conventional Commit messages from staged changes and JIRA story context, with optional AI polishing. Uses VS Code SecretStorage for API keys.",
  "publisher": "triwibowo",
  "version": "0.3.9",
  "license": "MIT",
  "icon": "icon.png",
  "repository": {
    "type": "git",
    "url": "https://github.com/deptz/jira-smart-commit.git"
  },
  "bugs": {
    "url": "https://github.com/deptz/jira-smart-commit/issues"
  },
  "homepage": "https://github.com/deptz/jira-smart-commit#readme",
  "keywords": [
    "commit",
    "jira",
    "commit message",
    "conventional commits",
    "git",
    "ai",
    "openai",
    "anthropic",
    "gemini",
    "scm",
    "productivity"
  ],
  "engines": {
    "vscode": "^1.92.0"
  },
  "categories": [
    "SCM Providers"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "jiraSmartCommit.generate",
        "title": "JIRA Smart Commit: Generate"
      },
      {
        "command": "jiraSmartCommit.insert",
        "title": "JIRA Smart Commit: Insert into Git Input"
      },
      {
        "command": "jiraSmartCommit.commit",
        "title": "JIRA Smart Commit: Commit Now"
      },
      {
        "command": "jiraSmartCommit.resetApiKey",
        "title": "JIRA Smart Commit: Reset AI API Key"
      },
      {
        "command": "jiraSmartCommit.setApiKey",
        "title": "JIRA Smart Commit: Set AI API Key (Settings)"
      },
      {
        "command": "jiraSmartCommit.resetJiraApiToken",
        "title": "JIRA Smart Commit: Reset JIRA API Token"
      },
      {
        "command": "jiraSmartCommit.generatePRDescription",
        "title": "JIRA Smart Commit: Generate PR Description",
        "icon": "$(git-pull-request)"
      },
      {
        "command": "jiraSmartCommit.firstPromptGenerator",
        "title": "JIRA Smart Commit: First Prompt Generator"
      },
      {
        "command": "jiraSmartCommit.reviewSecurity",
        "title": "JIRA Smart Commit: Review Security",
        "icon": "$(shield)"
      },
      {
        "command": "jiraSmartCommit.installHook",
        "title": "JIRA Smart Commit: Install Pre-commit Hook"
      }
    ],
    "configuration": {
      "title": "JIRA Smart Commit",
      "properties": {
        "jiraSmartCommit.baseUrl": {
          "type": "string",
          "markdownDescription": "Base URL of your JIRA Cloud/Server instance (e.g. `https://your.atlassian.net`)."
        },
        "jiraSmartCommit.email": {
          "type": "string",
          "markdownDescription": "JIRA account email used with API token."
        },
        "jiraSmartCommit.branchPattern": {
          "type": "string",
          "default": "(?:^|/)(?<key>[A-Z][A-Z0-9]+-\\d+)",
          "markdownDescription": "Regex with `(?<key>...)` capturing the JIRA key from branch name. Supports prefixes like `feature/`, `bugfix/`, etc."
        },
        "jiraSmartCommit.enableConventionalCommits": {
          "type": "boolean",
          "default": true,
          "description": "Emit Conventional Commit type/scope."
        },
        "jiraSmartCommit.commitTemplate": {
          "type": "string",
          "default": "",
          "editPresentation": "multilineText",
          "markdownDescription": "Custom template. Placeholders: `${type}`, `${scope}`, `${jira.summary}`, `${jira.oneLineDescription}`, `${jira.acceptanceBullets}`, `${jira.key}`, `${jira.relatedKeysFooter}`, `${changes.bullets}`."
        },
        "jiraSmartCommit.commitDirectly": {
          "type": "boolean",
          "default": false,
          "description": "If true, generate and commit immediately (skips preview)."
        },
        "jiraSmartCommit.scopeStrategy": {
          "type": "string",
          "enum": [
            "packageJson",
            "folder",
            "auto",
            "none"
          ],
          "enumDescriptions": [
            "Use package.json (Node.js), go.mod (Go), or folder name as fallback",
            "Use workspace folder name",
            "Auto-detect from changed files (Go modules, Rails resources, Clean Architecture layers)",
            "No scope"
          ],
          "default": "packageJson",
          "markdownDescription": "How to infer commit scope. **auto** is recommended for Go, Rails, and Clean Architecture projects."
        },
        "jiraSmartCommit.detectBreakingChanges": {
          "type": "boolean",
          "default": true,
          "description": "Add BREAKING hints when migrations or deletions detected."
        },
        "jiraSmartCommit.fetchRelatedIssues": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "Fetch related JIRA issues (subtasks, linked issues, parent) from JIRA API. When disabled, only the branch JIRA key will be used."
        },
        "jiraSmartCommit.relatedIssuesInFooter": {
          "type": "boolean",
          "default": true,
          "description": "Append related issue keys in Refs footer (only applies if fetchRelatedIssues is enabled)."
        },
        "jiraSmartCommit.includeJiraDetailsInBody": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "Include JIRA description and acceptance criteria in the commit body. When disabled (default), only the summary and file changes are included for cleaner Conventional Commits."
        },
        "jiraSmartCommit.descriptionMaxLength": {
          "type": "number",
          "default": 0,
          "markdownDescription": "Maximum characters from JIRA description to include (0 = unlimited, let token budget decide)."
        },
        "jiraSmartCommit.smartTruncation": {
          "type": "boolean",
          "default": true,
          "description": "Break truncated text at sentence/paragraph boundaries instead of mid-word."
        },
        "jiraSmartCommit.tokenAllocationStrategy": {
          "type": "string",
          "enum": [
            "balanced",
            "prefer-description",
            "prefer-diff"
          ],
          "default": "balanced",
          "markdownDescription": "How to allocate tokens between JIRA description and code diff. **balanced**: 40% description, 60% diff. **prefer-description**: up to 70% for description. **prefer-diff**: up to 70% for diff."
        },
        "jiraSmartCommit.includeCommitHistory": {
          "type": "boolean",
          "default": true,
          "description": "Include previous commits for the same JIRA ticket to provide context and avoid repetition."
        },
        "jiraSmartCommit.commitHistoryLimit": {
          "type": "number",
          "default": 5,
          "markdownDescription": "Maximum number of previous commits to include (default: 5, max: 10)."
        },
        "jiraSmartCommit.jiraKeyPosition": {
          "type": "string",
          "enum": [
            "footer",
            "subject-prefix",
            "subject-suffix"
          ],
          "default": "footer",
          "markdownDescription": "Where to place JIRA key in commit message. **footer**: `Refs: JIRA-123` (recommended). **subject-prefix**: `JIRA-123 feat(scope): message`. **subject-suffix**: `feat(scope): message [JIRA-123]`."
        },
        "jiraSmartCommit.ai.enabled": {
          "type": "boolean",
          "default": false,
          "description": "Enable AI polishing/synthesis of the generated commit message."
        },
        "jiraSmartCommit.ai.provider": {
          "type": "string",
          "enum": [
            "openai",
            "azure-openai",
            "anthropic",
            "gemini",
            "ollama",
            "moonshot",
            "team-gateway"
          ],
          "default": "openai",
          "description": "LLM provider to use. Use 'team-gateway' to connect to a centralized team gateway."
        },
        "jiraSmartCommit.ai.model": {
          "type": "string",
          "default": "gpt-4o-mini",
          "markdownDescription": "Model or deployment name. See examples below.",
          "enum": [
            "o1",
            "o3",
            "o3-mini",
            "o4-mini",
            "gpt-5.1",
            "gpt-5.1-codex",
            "gpt-5.1-codex-mini",
            "gpt-5-codex",
            "gpt-5",
            "gpt-5-mini",
            "gpt-5-nano",
            "gpt-5-turbo",
            "gpt-4.1",
            "gpt-4.1-mini",
            "gpt-4.1-nano",
            "gpt-4o",
            "gpt-4o-mini",
            "gpt-4-turbo",
            "gpt-3.5-turbo",
            "claude-sonnet-4-5",
            "claude-haiku-4-5",
            "claude-opus-4-1-20250805",
            "claude-opus-4-1",
            "claude-opus-4-20250514",
            "claude-opus-4-0",
            "claude-sonnet-4-20250514",
            "claude-sonnet-4-0",
            "claude-3-7-sonnet-20250219",
            "claude-3-7-sonnet-latest",
            "claude-3.5-sonnet",
            "claude-3.5-haiku",
            "claude-3-opus",
            "gemini-3-pro-preview",
            "gemini-2.5-pro",
            "gemini-2.5-flash",
            "gemini-2.5-flash-lite",
            "llama3.1:8b",
            "llama3.1:70b",
            "llama3.2:1b",
            "llama3.2:3b",
            "codellama:7b",
            "mistral:7b",
            "kimi-k2-turbo-preview",
            "kimi-k2-thinking-turbo",
            "kimi-k2-thinking",
            "kimi-k2-0905-preview",
            "kimi-k2-0711-preview",
            "kimi-latest",
            "kimi-thinking-preview",
            "moonshot-v1-auto",
            "moonshot-v1-128k",
            "moonshot-v1-32k",
            "moonshot-v1-8k",
            "moonshot-v1-128k-vision-preview",
            "moonshot-v1-32k-vision-preview",
            "moonshot-v1-8k-vision-preview",
            "custom"
          ],
          "markdownEnumDescriptions": [
            "OpenAI o1 (Reasoning model)",
            "OpenAI o3 (Reasoning model)",
            "OpenAI o3-mini (Reasoning model)",
            "OpenAI o4-mini (Reasoning model)",
            "OpenAI GPT-5.1 (Latest flagship model with enhanced reasoning)",
            "OpenAI GPT-5.1 Codex (Optimized for coding tasks)",
            "OpenAI GPT-5.1 Codex Mini (Fast coding model)",
            "OpenAI GPT-5 Codex (Legacy coding model)",
            "OpenAI GPT-5",
            "OpenAI GPT-5 Mini",
            "OpenAI GPT-5 Nano (High-throughput, cost-optimized)",
            "OpenAI GPT-5 Turbo",
            "OpenAI GPT-4.1",
            "OpenAI GPT-4.1 Mini",
            "OpenAI GPT-4.1 Nano",
            "OpenAI GPT-4o",
            "OpenAI GPT-4o Mini (fast & cheap)",
            "OpenAI GPT-4 Turbo",
            "OpenAI GPT-3.5 Turbo (legacy)",
            "Anthropic Claude Sonnet 4.5",
            "Anthropic Claude Haiku 4.5 (fast & cheap)",
            "Anthropic Claude Opus 4.1 (20250805)",
            "Anthropic Claude Opus 4.1",
            "Anthropic Claude Opus 4 (20250514)",
            "Anthropic Claude Opus 4.0",
            "Anthropic Claude Sonnet 4 (20250514)",
            "Anthropic Claude Sonnet 4.0",
            "Anthropic Claude 3.7 Sonnet (20250219)",
            "Anthropic Claude 3.7 Sonnet (latest)",
            "Anthropic Claude 3.5 Sonnet",
            "Anthropic Claude 3.5 Haiku (fast & cheap)",
            "Anthropic Claude 3 Opus",
            "Google Gemini 3 Pro Preview",
            "Google Gemini 2.5 Pro",
            "Google Gemini 2.5 Flash",
            "Google Gemini 2.5 Flash Lite",
            "Ollama Llama 3.1 8B",
            "Ollama Llama 3.1 70B",
            "Ollama Llama 3.2 1B",
            "Ollama Llama 3.2 3B",
            "Ollama CodeLlama 7B",
            "Ollama Mistral 7B",
            "Moonshot Kimi K2 Turbo Preview (262k context)",
            "Moonshot Kimi K2 Thinking Turbo (262k context)",
            "Moonshot Kimi K2 Thinking (262k context)",
            "Moonshot Kimi K2 0905 Preview (262k context)",
            "Moonshot Kimi K2 0711 Preview (131k context)",
            "Moonshot Kimi Latest (131k context)",
            "Moonshot Kimi Thinking Preview (131k context)",
            "Moonshot v1 Auto (131k context)",
            "Moonshot v1 128k",
            "Moonshot v1 32k",
            "Moonshot v1 8k",
            "Moonshot v1 128k Vision Preview",
            "Moonshot v1 32k Vision Preview",
            "Moonshot v1 8k Vision Preview",
            "Custom model name (for Azure deployments or other providers)"
          ]
        },
        "jiraSmartCommit.ai.baseUrl": {
          "type": "string",
          "default": "",
          "markdownDescription": "Optional custom base URL (Azure/OpenAI-compatible proxy, Ollama, or Team Gateway, e.g., `http://localhost:11434` or `https://gateway.yourteam.com/v1`)."
        },
        "jiraSmartCommit.ai.teamGatewayRequiresAuth": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "Whether the team gateway requires authentication. If true, you will be prompted for an API key that will be sent as a Bearer token."
        },
        "jiraSmartCommit.ai.maxTokens": {
          "type": "number",
          "default": 256,
          "description": "Upper bound on tokens in completion."
        },
        "jiraSmartCommit.ai.temperature": {
          "type": "number",
          "default": 0.2,
          "minimum": 0,
          "maximum": 2,
          "description": "Lower = more deterministic."
        },
        "jiraSmartCommit.ai.systemPrompt": {
          "type": "string",
          "default": "",
          "editPresentation": "multilineText",
          "markdownDescription": "System prompt override used to constrain style."
        },
        "jiraSmartCommit.ai.userPromptTemplate": {
          "type": "string",
          "default": "",
          "editPresentation": "multilineText",
          "markdownDescription": "User template with variables: ${format}, ${lang}, ${type}, ${scope}, ${breaking}, ${jira.key}, ${jira.summary}, ${jira.oneLineDescription}, ${jira.acceptanceBullets}, ${jira.relatedKeysFooter}, ${changes.bullets}."
        },
        "jiraSmartCommit.ai.format": {
          "type": "string",
          "enum": [
            "conventional",
            "plain"
          ],
          "default": "conventional",
          "description": "Output format guardrail."
        },
        "jiraSmartCommit.ai.language": {
          "type": "string",
          "default": "en",
          "description": "Language for the final message (e.g., 'en', 'id')."
        },
        "jiraSmartCommit.pr.enabled": {
          "type": "boolean",
          "default": true,
          "markdownDescription": "Enable PR Description Generator feature. **Requires GitHub Copilot** to be installed and active."
        },
        "jiraSmartCommit.pr.promptTemplate": {
          "type": "string",
          "default": "You are a Staff Software Engineer and expert technical writer specializing in pull request documentation.\nYour job is to produce an accurate, reviewer-ready PR description based ONLY on the complete, up-to-date diff of the current branch.\n\n--------------------------------------------\n### MANDATORY SYNC REQUIREMENT (BLOCKING RULE)\n\nYou MUST ensure that the local branch is fully synced with its remote tracking branch\n(e.g. origin/<current-branch>) so that **all commits on origin are present locally**.\n\nThe intended workflow is:\n\n  git fetch origin\n  git pull --ff-only          # or an equivalent fast-forward from the remote tracking branch\n\nThe exact command may differ, but the invariant is:\n- The local HEAD is **not behind** its remote tracking branch.\n- There are **no missing commits** from origin on this branch.\n\nIf the context does NOT clearly indicate that:\n- the latest changes have been fetched from origin, AND\n- the local branch is up to date with its remote tracking branch (no \"behind X\" state),\n\nthen you MUST refuse to generate the PR description and instead return ONLY:\n\n\"The local branch is behind origin.  \nPlease sync your branch so that all commits from origin are present locally  \n(e.g. run `git fetch origin` and then fast-forward your current branch),  \nthen regenerate the PR context.\"\n\nYou MUST NOT proceed if there is any indication that local is behind origin.\n\n--------------------------------------------\n### BEHAVIOR RULES\n\n- Base ALL statements strictly on the diff after sync.\n- Never invent behavior, intentions, or business logic not visible in the context.\n- Prefer precise technical language: file paths, components, endpoints, modules.\n- Group changes into meaningful areas (backend, API, frontend, tests, infra, config, docs).\n- Explicitly call out risks, breaking changes, and missing context.\n- Keep output concise, scannable, and reviewer-focused.\n\n--------------------------------------------\n### INTERNAL REASONING (HIDDEN FROM OUTPUT)\n\n1. Confirm that the local branch is synced with its remote tracking branch (no missing commits from origin).\n2. Parse the diff: added/removed/modified/refactored files.\n3. Group changes into logical categories.\n4. Infer intent only when it is clearly supported by the changes.\n5. Identify impacted systems, risks, and dependencies.\n6. Detect gaps or missing information.\n\n--------------------------------------------\n### OUTPUT FORMAT (RETURN ONLY THIS)\n\n## Summary\n- 2–3 sentence overview of what changed.\n- Include JIRA ticket reference only if present in the context.\n- High-level technical impact.\n\n## What Changed\n- Group changes by category (backend, API, frontend, tests, infra, config, docs).\n- Each bullet references specific files/components and concrete changes.\n- No speculation.\n\n## Testing\n- Clear steps to test the changes.\n- Preconditions (accounts, flags, env, data).\n- Expected results.\n\n## Impact & Risks\n- Systems/components affected.\n- Breaking changes or migrations.\n- Performance/security implications.\n- Any uncertainty due to incomplete context.\n\n## Additional Notes\n- Dependencies or follow-up work.\n- Required config or environment changes.\n- Deployment considerations.\n\n## Missing Context\n- Anything the diff does not make clear (e.g. business purpose, external dependencies).\n- Questions the reviewer or author should clarify.\n\n--------------------------------------------\n### CONTEXT\n{{CONTEXT}}",
          "editPresentation": "multilineText",
          "markdownDescription": "Template for PR description generation. Use {{CONTEXT}} placeholder for commits, diffs, JIRA data, and coverage information."
        },
        "jiraSmartCommit.pr.autoSubmit": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "Automatically submit PR description to GitHub Copilot Chat. If false, will show preview for manual review."
        },
        "jiraSmartCommit.firstPrompt.autoSubmit": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "Automatically submit prompt to GitHub Copilot Chat. If false, prompt will be copied to clipboard for manual submission."
        },
        "jiraSmartCommit.firstPrompt.taskTemplate": {
          "type": "string",
          "default": "You are a Staff Engineer responsible for designing and implementing new features.\nYou prioritize correctness, security, maintainability, and consistency with the existing architecture.\nYou never guess silently. If requirements or constraints are unclear, you ask.\n### CORE PRINCIPLES\n- Design before code: architecture and responsibilities come first.\n- Minimal surface area: change only what needs to be changed.\n- Consistency: follow existing patterns, styles, and abstractions.\n- Defensiveness: validate inputs, handle failure modes, avoid security pitfalls.\n### HOW TO THINK (INTERNAL ONLY)\nYou must use the following reasoning process, but do NOT include it in the final answer.\n\n1. Restate the feature in your own words.\n2. Extract and list the explicit requirements and acceptance criteria.\n3. Identify missing or ambiguous requirements. Flag them.\n4. Break the feature into components (API, domain logic, persistence, background jobs, UI, etc.).\n5. For each component, define:\n   - responsibility\n   - inputs/outputs\n   - dependencies\n6. Design the minimal set of changes to:\n   - data models / schemas (if any)\n   - APIs / handlers / controllers\n   - services / use-cases\n   - background jobs / async flows\n7. Check the design against:\n   - security concerns (auth, authz, injection, data leaks)\n   - performance constraints\n   - failure modes\n8. Plan tests that prove the behavior and prevent regressions.\n\n### REQUIRED INPUTS (FROM USER)\nThe user will provide some combination of:\n- Feature description and/or user story\n- Acceptance criteria\n- Existing code structure (files, modules, endpoints)\n- API contracts or schemas (if any)\n- Tech stack / framework (if not obvious from code)\n\nIf critical items are missing, you must ask clarifying questions BEFORE proposing final code.\n\nINPUT:\n{{DESCRIPTION}}",
          "editPresentation": "multilineText",
          "markdownDescription": "Template for Task/Story type issues. Use {{DESCRIPTION}} placeholder for JIRA description."
        },
        "jiraSmartCommit.firstPrompt.bugTemplate": {
          "type": "string",
          "default": "You are a Staff Engineer specializing in debugging complex production issues.\nYour job is to identify the most likely root cause using ONLY the evidence provided.\nYou never hand-wave. You never guess silently. You surface uncertainty explicitly.\n\n### CORE PRINCIPLES\n- Hypothesis-driven: always think in terms of multiple possible causes.\n- Evidence-based: every conclusion must be justified by logs, code, or behavior.\n- Minimal fix: propose the smallest safe change that resolves the issue.\n- No invention: never fabricate stack traces, logs, or behavior.\n\n### HOW TO THINK (INTERNAL ONLY)\nYou must follow this internal reasoning process.\nDo NOT include this reasoning in the final answer.\n\n1. Restate the visible symptoms in your own words.\n2. Identify the minimal set of components involved (files, services, endpoints, DB tables, etc.).\n3. List all plausible hypotheses that could explain the symptoms.\n4. Test each hypothesis against the evidence:\n   - Which logs/lines support it?\n   - Which contradict it?\n5. Eliminate hypotheses that don't match the evidence.\n6. Choose the most likely root cause and check for contradictions.\n7. Design the smallest, lowest-risk fix.\n8. Consider potential side effects or regressions.\n\n\n### REQUIRED INPUTS (FROM USER)\nThe user will provide some combination of:\n- Code snippets or files\n- Logs / stack traces / errors\n- Environment details (env, version, config)\n- Steps to reproduce (if available)\n\nIf any of these are clearly missing and needed, ask for them before giving a final answer.\n \nINPUT:\n {{DESCRIPTION}}",
          "editPresentation": "multilineText",
          "markdownDescription": "Template for Bug type issues. Use {{DESCRIPTION}} placeholder for JIRA description."
        },
        "jiraSmartCommit.security.enabled": {
          "type": "boolean",
          "default": true,
          "markdownDescription": "Enable Security Review feature. **Requires GitHub Copilot** to be installed and active."
        },
        "jiraSmartCommit.security.promptTemplate": {
          "type": "string",
          "default": "You are a Senior Staff Application Security Engineer.\n\nYour job: Perform an exact, deterministic security review of ALL code changes in the CURRENT BRANCH.\n\nYou MUST:\n\n- Retrieve real repository context yourself.\n\n- Analyze ALL commits on the current branch.\n\n- Produce output following the EXACT Output Contract defined below.\n\n- Never fabricate or infer missing diffs.\n\n----------------------------------------------------------------------\n\nREQUIRED DATA COLLECTION (AUTOMATED)\n\n----------------------------------------------------------------------\n\nYou MUST retrieve the following BEFORE analysis:\n\n1. CURRENT BRANCH NAME.\n\n2. ALL COMMITS ON THIS BRANCH.\n\n   Retrieve the commit list equivalent to:\n\n       git log --oneline\n\n   Do NOT ask the user to run commands.\n\n3. UNIFIED DIFF FOR ALL COMMITS ON THE BRANCH.\n\n   Retrieve the unified diff equivalent to:\n\n       git log -p\n\n   Or get diff from first commit to HEAD:\n\n       git diff <first-commit>^..HEAD\n\n4. STAGED CHANGES.\n\n   Equivalent to:\n\n       git diff --cached\n\n5. LIST OF FILES CHANGED IN BRANCH.\n\n   Equivalent to:\n\n       git diff --name-status <first-commit>^..HEAD\n\n6. AUTO-DETECT FRAMEWORK & SECURITY CONTEXT:\n\n   - language(s)\n\n   - frameworks (Rails, Django, Express, Spring, etc.)\n\n   - ORM/DB layers\n\n   - Auth/ACL middleware\n\n   - Validation libraries\n\n7. RELEVANT CONFIG/SECRETS:\n\n   - .env templates\n\n   - config/*, settings/*\n\n   - dependency manifests (Gemfile, go.mod, package.json, etc.)\n\nAny missing input MUST be reported in the \"Limitations\" section.\n\n----------------------------------------------------------------------\n\nSECURITY ANALYSIS SCOPE\n\n----------------------------------------------------------------------\n\nYou MUST check the diffs against:\n\nOWASP TOP TEN:\n\n- A01 Broken Access Control (including IDOR)\n\n- A02 Cryptographic Failures\n\n- A03 Injection (SQLi, NoSQLi, LDAP, Template, Code, OS command)\n\n- A04 Insecure Design\n\n- A05 Security Misconfiguration\n\n- A06 Vulnerable and Outdated Components\n\n- A07 Identification & Authentication Failures\n\n- A08 Software & Data Integrity Failures\n\n- A09 Logging and Monitoring Failures\n\n- A10 SSRF\n\nMANDATORY ADDITIONAL CATEGORIES:\n\n- Hardcoded secrets\n\n- Multi-tenant isolation breaches\n\n- Unsafe redirect/URL manipulation\n\n- Directory traversal\n\n- Unsafe file uploads\n\n- Unsafe deserialization\n\n- Weak random number generation\n\n- Insecure error handling\n\n- Side-channel leaks (timing, response variance)\n\n- Business logic abuse routes\n\nSQL INJECTION DEEP SCAN:\n\nFor EVERY DB-related change:\n\n- classify: SAFE / SUSPICIOUS / LIKELY VULNERABLE\n\n- track data flow from input → query\n\n- identify raw concatenation, unescaped variables, ORM bypass\n\n----------------------------------------------------------------------\n\nSTRICT OUTPUT CONTRACT\n\n----------------------------------------------------------------------\n\nYOU MUST FOLLOW THIS EXACT OUTPUT STRUCTURE.\n\nNO EXTRA HEADINGS.\n\nNO REORDERING.\n\nNO OMISSIONS.\n\nNO COMMENTARY OUTSIDE THESE SECTIONS.\n\n======================\n\n1. SUMMARY\n\n======================\n\n- 3–6 bullet points describing the overall security posture of THIS BRANCH'S CHANGES ONLY.\n\n- Must include: \"Severe findings: Yes/No\"\n\n======================\n\n2. HIGH-RISK FINDINGS (Critical / High)\n\n======================\n\nFor EACH finding:\n\n### FINDING <N>\n\n- **ID:** SHORT_TAG (uppercase, underscores)\n\n- **Location:** file_path:line_range\n\n- **Category:** OWASP category (e.g., A03: Injection – SQLi)\n\n- **Severity:** Critical / High\n\n- **Description:** 2–4 sentences explaining the vulnerability.\n\n- **Exploit Scenario:** Attack narrative (2–5 sentences).\n\n- **Recommended Fix:** Precise, framework-aware, no generic advice.\n\nIF THERE ARE NO HIGH-RISK FINDINGS:\n\nWrite exactly:\n\n\"No high-risk findings detected.\"\n\n======================\n\n3. MEDIUM / LOW-RISK FINDINGS\n\n======================\n\nSame format as above, but shorter (2–3 sentences each).\n\nIF NONE:\n\nWrite exactly:\n\n\"No medium or low-risk findings detected.\"\n\n======================\n\n4. SQL INJECTION REVIEW\n\n======================\n\nFor EACH changed query:\n\n- **Location:** file_path:line_range\n\n- **Snippet:** minimal relevant code\n\n- **Classification:** SAFE / SUSPICIOUS / LIKELY VULNERABLE\n\n- **Rationale:** 1–2 sentences.\n\nIF NO SQL changes:\n\nWrite exactly:\n\n\"No SQL-relevant changes detected.\"\n\n======================\n\n5. OWASP COVERAGE CHECKLIST\n\n======================\n\nFor each A01–A10:\n\n- A01 Broken Access Control: <Covered & Issues Found | Covered & No Issues Found | Not Enough Context>\n\n- A02 Cryptographic Failures: <...>\n\n...\n\n- A10 SSRF: <...>\n\n======================\n\n6. RISKY PATTERNS TO WATCH\n\n======================\n\nBullet list of non-vulnerabilities that signal weak posture.\n\nIF NONE:\n\nWrite exactly:\n\n\"No risky patterns identified.\"\n\n======================\n\n7. LIMITATIONS / MISSING CONTEXT\n\n======================\n\n- List exactly what repository data could not be retrieved.\n\n- No filler text.\n\n======================\n\n----------------------------------------------------------------------\n\nEXECUTION\n\n----------------------------------------------------------------------\n\nBegin by retrieving:\n\n- branch name\n\n- all commits on current branch\n\n- full diff for all commits\n\n- staged diff\n\n- changed files\n\n- config context\n\nThen generate the report STRICTLY following the Output Contract.\n\n## INPUT DATA\n\n### RECENT_COMMITS_DIFF\n\n{{RECENT_COMMITS_DIFF}}\n\n### STAGED_CHANGES_DIFF\n\n{{STAGED_CHANGES_DIFF}}\n\n### FRAMEWORK_CONTEXT\n\n{{FRAMEWORK_CONTEXT}}",
          "editPresentation": "multilineText",
          "markdownDescription": "Template for security review generation. Use {{RECENT_COMMITS_DIFF}}, {{STAGED_CHANGES_DIFF}}, and {{FRAMEWORK_CONTEXT}} placeholders."
        },
        "jiraSmartCommit.security.autoSubmit": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "Automatically submit security review to GitHub Copilot Chat. If false, will paste into chat for manual review."
        }
      }
    }
  },
  "scripts": {
    "vscode:prepublish": "npm run build",
    "build": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "test": "echo \"(placeholder) add tests in ./test\" && exit 0"
  },
  "devDependencies": {
    "@types/node": "^20.14.2",
    "@types/node-fetch": "^2.6.4",
    "@types/vscode": "^1.92.0",
    "@vscode/test-electron": "^2.4.1",
    "typescript": "^5.5.4"
  },
  "dependencies": {
    "node-fetch": "^2.7.0"
  }
}